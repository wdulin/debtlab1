<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>debtlab-basic.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/DebtLabBasic.html">DebtLabBasic</a></li>
            
                <li><a href="..&#x2F;classes/SimulatorApp.html">SimulatorApp</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: debtlab-basic.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">





&#x2F;**
* 
* Encapsulates the domain logic of the Debt simulator. Properties are
* set and transactions called using methods. The App class is responsible 
* for calling the stepSimulation to progress the simulation a day or
* a preset multiple of days.
* 
* @class DebtLabBasic 
* @constructor
*&#x2F;
function DebtLabBasic() {

    &#x2F;**
     * Default amount to add when add to lender account command is invoked.
     * 
     * @property DEFAULT_ADD_TO_LENDER_ACCOUNT_AMOUNT
     * @type int
     * @static
     * @final
	 *&#x2F;
	this.DEFAULT_ADD_TO_LENDER_ACCOUNT_AMOUNT = 1000;
	&#x2F;**
	 * Starting value for money supply
	 *&#x2F;
	this.DEFAULT_STARTING_MONEY_SUPPLY = 10000;
    &#x2F;**
     * Starting value for target money supply
	 *&#x2F;
    this.DEFAULT_BEGINNING_TARGET_MONEY_SUPPLY = 10000;
    
    &#x2F;**
	 * If true then money is borrowed as necessary
	 *&#x2F;
    this.DEFAULT_AUTO_BORROW = false;
    
	&#x2F;**
	 * If true then lender account is added to as necessary 
	 *&#x2F;
	this.DEFAULT_AUTO_ADD_TO_LENDER_ACCOUNT = false;
	&#x2F;**
	 * if true target money supply is maintained by creating public money with no
	 * interest load
	 *&#x2F;
	this.DEFAULT_AUTO_CREATE_PUBLIC_MONEY = false;
	&#x2F;**
	 * if true then money is lent from money on deposit as required
	 *&#x2F;
    this.DEFAULT_AUTO_LEND_FROM_LENDER_DEPOSITS = false;
	&#x2F;**
	 * if true auto lender spend starts off as on
	 *&#x2F;
	this.DEFAULT_AUTO_LENDER_SPEND = false;
	&#x2F;**
	 * If true target money supply grows at current rate
	 *&#x2F;
	this.DEFAULT_AUTO_TARGET_MONEY_SUPPLY_GROW = true;
	&#x2F;**
	 * If true then lender is taxed on interest at the current rate when loans are
	 * paid back. Tax money goes back to money supply.
	 *&#x2F;
	this.DEFAULT_AUTO_TAX_LENDER = false;
	&#x2F;**
	 * Amount lender account starts off with
	 *&#x2F;
	this.DEFAULT_BEGINNING_LENDER_BALANCE = 10000;
	&#x2F;**
	 * Beginning amount in money on deposit. It is maintained at 50% of money supply
	 * during operation.
	 *&#x2F;
	this.DEFAULT_BEGINNING_LENDER_DEPOSIT_BALANCE = 5000;
	&#x2F;**
	 * amount of public money to create on command
	 *&#x2F;
	this.DEFAULT_CREATE_PUBLIC_MONEY_AMOUNT = 100;
	&#x2F;**
	 * Default starting days per minute for speed of simulator.
	 *&#x2F;
	this.DEFAULT_YEARS_PER_MINUTE = 6;
	&#x2F;**
	 * If true default on payback starts off as true.
	 *&#x2F;
	this.DEFAULT_DEFAULT_ON_PAY_BACK = false;
	&#x2F;**
	 * Default lender spend rate of interest earned
	 *&#x2F;
	this.DEFAULT_LENDER_SPEND_RATE = 0.05;
	&#x2F;**
	 * Default rate to tax lender on interest payments.
	 *&#x2F;
    this.DEFAULT_LENDER_TAX_RATE = 0.05;
	&#x2F;**
	 * Default principal for newly created notes.
	 *&#x2F;
	this.DEFAULT_NOTE_AMOUNT = 100;
	&#x2F;**
	 * Default interest rate for newly created notes.
	 *&#x2F;
	this.DEFAULT_NOTE_INTEREST_RATE = 0.05;
	&#x2F;**
	 * Default term in days for newly created notes.
	 *&#x2F;
    this.DEFAULT_NOTE_TERM_DAYS = 90;
	&#x2F;**
	 * Default rate at which target money supply should grow
	 *&#x2F;
	this.DEFAULT_TARGET_MONEY_SUPPLY_GROWTH_RATE = 0.05;
    &#x2F;**
     * Default multiplier for simulation day increment
	 *&#x2F;
	this.DEFAULT_SPEED_MULTIPLIER = 1;
    
    &#x2F;**
     * Number of steps to count before
     * processing auto flags
     *&#x2F;
	this.DEFAULT_AUTO_COUNT_INTERVAL = 30;
    
    
    &#x2F;**
     * Milliseconds in a day.
	 *&#x2F;
    this. DAY_MS = 60 * 60 * 1000 * 24;
    
    &#x2F;**
     * Length of trending data
     *&#x2F;
     this.TREND_ARRAY_LENGTH = 12;
    
    
     &#x2F;**
	 * Feature 17: While activated erases loans erases loans that come due without
	 * paying back to lender account or debit from money supply.
	 *&#x2F;
	this.defaultOnPayBackFlag = false;
	&#x2F;**
	 * if true lender account is automatically added to as necessary
	 *&#x2F;
	this.autoAddToLenderAccountFlag;
    
    
    &#x2F;**
     * if true money is automatically borrowed as needed
	 *&#x2F;
	this.autoBorrowFlag = false;
    
    
	&#x2F;**
	 * if true public money is created as needed
	 *&#x2F;
	this.autoCreatePublicMoneyFlag = false;
	&#x2F;**
	 * return the current state of the auto spend flag
	 *&#x2F;
	this.autoLenderSpendFlag = false;
	&#x2F;**
	 * if true loans are made from the deposits account
	 *&#x2F;
	this.autoLendFromLenderDepositsFlag;
	&#x2F;**
	 * if true target money supply increases automatically default is true
	 *&#x2F;
	this.autoTargetMoneySupplyGrowFlag = true;
	&#x2F;**
	 * if true lender interest is automatically taxed at the current rate
	 *&#x2F;
	this.autoTaxLenderFlag;
	&#x2F;**
	 * Amount to add to money supply when creating public money
	 *&#x2F;
	this.createPublicMoneyAmount  = 100;
    
    
    this.publicMoneyCreated = 0;
    
    
	&#x2F;**
	 * current money supply of economy
	 *&#x2F;
	this.currentMoneySupply = 10000;
    
    &#x2F;**
     * keep track of last money supply change
	 *&#x2F;
    this.lastMoneySupply = 10000;
    this.lastMoneySupplyDayNumber = 0;
    
    
    
	&#x2F;**
	 * current day counter for tracking notes
	 *&#x2F;
	this.currentDayNumber = 0;
	&#x2F;**
	 * rate of time passage as days per minute
	 *&#x2F;
    this.yearsPerMinute = 6;
	&#x2F;**
	 * Amount to add to lender account when doAddToLenderAccount
	 *&#x2F;
	this.lenderAccountAddAmount = 1000;
	&#x2F;**
	 * current lender account balance
	 *&#x2F;
	this.lenderAccountBalance  = 1000;
	&#x2F;**
	 * Current amount on deposit Maintained as 50% of money supply 
	 *&#x2F;
	this.lenderDepositsBalance   = 5000;
	&#x2F;**
	 * Percentage of last interest payment to move back to money supply when
	 * doLenderSpend is called
	 *&#x2F;
	this.lenderSpendRate = 0.05;
	&#x2F;**
	 * percent of last interest payment to transfer to money supply when doTaxLender
	 * is called
	 *&#x2F;
	this.lenderTaxRate  = 0.05;
	&#x2F;**
	 * Principal for newly created notes 
	 *&#x2F;
    this.noteAmount = 100;
	&#x2F;**
	 * Interest rate for newly created notes
	 *&#x2F;
    this.noteInterestRate = 0.05;
	&#x2F;**
	 * collection class of outstanding notes
	 *&#x2F;
	&#x2F;&#x2F;   ****  TODO: this.NotesOutstanding notes = null;
	&#x2F;**
	 * Term in days for newly created notes
	 *&#x2F;
	this.noteTermDays = 90;
	&#x2F;**
	 * current goal for money supply level
	 *&#x2F;
	this.targetMoneySupply = 10000;
	&#x2F;**
	 * rate at which target money supply grows every year
	 *&#x2F;
	this.targetMoneySupplyGrowthRate = 0.05;
    
    &#x2F;**
     * Default multiplier for simulation day increment
     *&#x2F;
	this.multiplier = 1; 
    
    &#x2F;**
     * Number of steps to count before
     * processing auto flags
     *&#x2F;
     this.autoCountInterval = 30;
    
    &#x2F;**
     * Counter for interval for processing automatic parameters
     *&#x2F;
     this.autoCounter = 0;
    
    &#x2F;**
     * Total interest paid to lenders
     *&#x2F;
     this.interestPaid = 0;
   
    &#x2F;**
     * Interest trend
     *&#x2F;
     this.interestPaidTrend = 0.0;
     
     &#x2F;**
      * Current amount owed to lender
      *&#x2F;
     this.debtToLender = 0;
      
     &#x2F;**
      * Debt to Lender trend
      *&#x2F;
     this.debtToLenderTrend = 0.0;
      
     &#x2F;**
      * Last interest amount for calculating 
      * Lender spending and taxes
      *&#x2F;
      this.lastInterestPayment = 0;
      
      
      &#x2F;**
       * Notes payed queue - for use in 
       * displaying a note payed event in 
       * the UI.
       *&#x2F;
       this.notesPayedQueue = 0;
       
       &#x2F;**
       * Notes defaulted queue - for use in 
       * displaying a note default event in 
       * the UI.
       *&#x2F;
       this.notesDefaultedQueue = 0;
      
      
    &#x2F;**
     * Notes outstanding array
     *&#x2F;
     this.notesOutstanding = [];
     
    
    &#x2F;&#x2F; Added fields
    
    this.currDate = new Date(2000, 0, 1);
    
    &#x2F;**
     * Year counter
    *&#x2F;
   

}







DebtLabBasic.prototype.stepSimulation = function () {
    if (this.yearsPerMinute &gt; 9 ) {
        this.multiplier = 1; &#x2F;&#x2F; this.multiplier = 10;
    } else {
        this.multiplier = 1;
    }
    this.currDate = new Date(this.currDate.getTime() + (this.DAY_MS * this.multiplier));
    this.currentDayNumber += this.multiplier;
    &#x2F;&#x2F; this.currentMoneySupply += 1;
    this.autoCounter += this.multiplier;
    
    this.paybackNotes();
    
    &#x2F;&#x2F; Don&#x27;t call handleAutoFlags every step to
    &#x2F;&#x2F; avoid rounding problems on yearly percentage rates
    if ( this.autoCounter &gt;= this.autoCountInterval) {
        this.handleAutoFlags();
        this.autoCounter = 0;
    }
    
 
    
    
};

&#x2F;**
 * Payback note
 *&#x2F;
DebtLabBasic.prototype.paybackNotes = function() {
    
    &#x2F;&#x2F; TODO: Complete this feature
    var principal = 0,
        interest = 0;
    for(var i = this.notesOutstanding.length - 1; i &gt;= 0; i--) {
        console.log(&quot;daynum:&quot;, this.currentDayNumber);
        console.log(&quot;due:&quot;, this.notesOutstanding[i].due);
        console.log(&quot;amount:&quot;, this.notesOutstanding[i].amount);
        console.log(&quot;interest:&quot;, this.notesOutstanding[i].interest);
        
        if(this.notesOutstanding[i].due &lt;= this.currentDayNumber ) {
            principal = this.notesOutstanding[i].amount;
            interest = this.notesOutstanding[i].interest;
            
            if(this.defaultOnPayBackFlag) {
                this.debtToLender -= (principal + interest);
                this.notesDefaultedQueue += 1;
            } else {
                this.lenderAccountBalance += (principal + interest);
                this.addInterestPaid(interest);
                this.debtToLender -= (principal + interest);
                this.setMoneySupply(this.currentMoneySupply -= (principal + interest));
                this.notesPayedQueue += 1;
                this.lastInterestPayment = interest;
                
                &#x2F;&#x2F; Handle lender auto tax
                if(this.autoTaxLenderFlag) {
                    this.doTaxLender();
                }
                
                &#x2F;&#x2F; Handle lender auto spend
                if(this.autoLenderSpendFlag) {
                    this.doLenderSpend();
                }
            }
            &#x2F;&#x2F; remove note
            this.notesOutstanding.splice(i,1);
        }
    }
   
};


&#x2F;**
 * Set all simulator values to defaults
 *&#x2F;
DebtLabBasic.prototype.doResetToDefaults = function () {
    
    this.defaultOnPayBackFlag = this.DEFAULT_DEFAULT_ON_PAY_BACK;
    this.autoAddToLenderAccountFlag = this.DEFAULT_AUTO_ADD_TO_LENDER_ACCOUNT;
	 
	this.autoCreatePublicMoneyFlag = this.DEFAULT_AUTO_CREATE_PUBLIC_MONEY;
 
	this.autoLenderSpendFlag = this.DEFAULT_AUTO_LENDER_SPEND;
	
	this.autoLendFromLenderDepositsFlag = this.DEFAULT_AUTO_LEND_FROM_LENDER_DEPOSITS;

	this.autoTargetMoneySupplyGrowFlag = this.DEFAULT_AUTO_TARGET_MONEY_SUPPLY_GROW;
	
	this.autoTaxLenderFlag = this.DEFAULT_AUTO_TAX_LENDER;
    
    this.autoBorrowFlag = this.DEFAULT_AUTO_BORROW;



	this.createPublicMoneyAmount  = this.DEFAULT_CREATE_PUBLIC_MONEY_AMOUNT;

    this.publicMoneyCreated = 0;

	this.currentMoneySupply  =  this.DEFAULT_STARTING_MONEY_SUPPLY;
    this.lastMoneySupply =  this.DEFAULT_STARTING_MONEY_SUPPLY;
    this.lastMoneySupplyDayNumber = 0;
    this.moneySupplyTrend = 0.0;
   
	
    this.yearsPerMinute = this.DEFAULT_YEARS_PER_MINUTE;

	this.lenderAccountAddAmount = this.DEFAULT_ADD_TO_LENDER_ACCOUNT_AMOUNT;

	this.lenderAccountBalance  = this.DEFAULT_BEGINNING_LENDER_BALANCE;
	
	this.lenderDepositsBalance  = this.DEFAULT_BEGINNING_LENDER_DEPOSIT_BALANCE;
	
	this.lenderSpendRate = this.DEFAULT_LENDER_SPEND_RATE;
	
	this.lenderTaxRate  = this.DEFAULT_LENDER_TAX_RATE;
	
    this.noteAmount = this.DEFAULT_NOTE_AMOUNT;
	
    this.noteInterestRate = this.DEFAULT_NOTE_INTEREST_RATE;

	&#x2F;&#x2F;   ****  TODO: this.NotesOutstanding notes = null;

	this.noteTermDays = this.DEFAULT_NOTE_TERM_DAYS;

	this.targetMoneySupply = this.DEFAULT_BEGINNING_TARGET_MONEY_SUPPLY;
    
	
	this.targetMoneySupplyGrowthRate = this.DEFAULT_TARGET_MONEY_SUPPLY_GROWTH_RATE;
    
    this.multiplier = this.DEFAULT_SPEED_MULTIPLIER;
    
    this.autoCountInterval = this.DEFAULT_AUTO_COUNT_INTERVAL;
     
    this.autoCounter = 0;
    
    this.interestPaid = 0;
    this.interestPaidTrend = 0.0;
    
    this.debtToLender = 0;
      
    this.debtToLenderTrend = 0.0;
    
    this.lastInterestPayment = 0;
    
    this.notesPayedQueue = 0;
       
    this.notesDefaultedQueue = 0;
    
    &#x2F;&#x2F; clear notes outstanding
    this.notesOutstanding = [];

 
};

DebtLabBasic.prototype.initClock = function (date) {
    this.currentDayNumber = 0;
    this.currDate = date;
};

DebtLabBasic.prototype.getDate = function() {
    return this.currDate;
};

DebtLabBasic.prototype.getDayNumber = function() {
    return this.currentDayNumber;
};

DebtLabBasic.prototype.getYearsPerMinute = function() {
   
    return this.yearsPerMinute;
};

DebtLabBasic.prototype.setYearsPerMinute = function(value) {
    console.log(value);
    if(value &lt; 50 &amp;&amp; value &gt; 0) {
        this.yearsPerMinute = value;
    } else {
        this.yearsPerMinute = 2;
    }
};









DebtLabBasic.prototype.setAutoLendFromLenderDepositsFlag = function(value) {
    this.autoLendFromLenderDepositsFlag = value;
};

DebtLabBasic.prototype.getAutoLendFromLenderDepositsFlag = function() {
    return this.autoLendFromLenderDepositsFlag;
};

DebtLabBasic.prototype.multiplier= function(value) {
    this.multiplier = value;
};

DebtLabBasic.prototype.multiplier = function() {
    return this.multiplier;
};


&#x2F;&#x2F; ******** Public Money *********

&#x2F;**
 * Create public money adds non-debt money to
 * the money supply and keeps track of how much
 * has been created.
 *&#x2F;
DebtLabBasic.prototype.doCreatePublicMoney = function() {
    this.setMoneySupply(this.currentMoneySupply += this.createPublicMoneyAmount);
    this.publicMoneyCreated += this.createPublicMoneyAmount;
};

&#x2F;**
 * Sets the simulator to automatically create public money on demand.
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setAutoCreatePublicMoneyFlag = function(value) {
    this.autoCreatePublicMoneyFlag = value;
};

&#x2F;**
 * Returns a boolean indicating if the simulator is automatically creating
 * public money on demand.
 * 
 * @returns {boolean} current value of auto create public money.
 *&#x2F;
DebtLabBasic.prototype.getAutoCreatePublicMoneyFlag = function() {
    return this.autoCreatePublicMoneyFlag;
};



&#x2F;**
 * Sets the amount of public money to add to money supply.
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.setCreatePublicMoneyAmount = function(value) {
    this.createPublicMoneyAmount = value;
};

&#x2F;**
 * Returns the current amount the simulator is using to add to money supply.
 * 
 * @returns {int} Current value of create public money amount.
 *&#x2F;
DebtLabBasic.prototype.getCreatePublicMoneyAmount = function() {
    return this.createPublicMoneyAmount;
};



&#x2F;&#x2F; ******** Target Money Supply *********


&#x2F;**
 * Sets the simulator to automatically increase the target money supply.
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setAutoTargetMoneySupplyGrow = function(value) {
    this. autoTargetMoneySupplyGrowFlag = value;
};

&#x2F;**
 * Returns a boolean indicating if the simulator is automatically
 * increasing the target money supply.
 * 
 * @returns {boolean} current value of auto increase target money supply.
 *&#x2F;
DebtLabBasic.prototype.getAutoTargetMoneySupplyGrow = function() {
    return this.autoTargetMoneySupplyGrowFlag;
};



&#x2F;**
 * Target money supply is the value for money supply that the 
 * simulation tries to maintain. This sets the target money supply.
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.setTargetMoneySupply = function(value) {
    this.targetMoneySupply = value;
};

&#x2F;**
 * Returns the current value of the target money supply.
 * 
 * @returns {int} Current value of the target money supply.
 *&#x2F;
DebtLabBasic.prototype.getTargetMoneySupply = function() {
    return this.targetMoneySupply;
};

&#x2F;**
 * Growth rate for the target money supply.
 * 
 * @param {float} value 
 *&#x2F;
DebtLabBasic.prototype.setTargetMoneySupplyGrowthRate = function(value) {
    this.targetMoneySupplyGrowthRate = value;
};

&#x2F;**
 * Returns the current value of the target money supply growth rate.
 * 
 * @returns {float} Current value of the target money growth rate.
 *&#x2F;
DebtLabBasic.prototype.getTargetMoneySupplyGrowthRate = function() {
    return this.targetMoneySupplyGrowthRate;
};

&#x2F;&#x2F; ******** Money Supply *********

&#x2F;**
 * Money supply is total money in the economy available for commerce. 
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.setMoneySupply = function(value) {
    
    &#x2F;&#x2F; Dampen change rate calculation
    var days = this.currentDayNumber - this.lastMoneySupplyDayNumber;
    if(days &gt; this.autoCountInterval) {
        var diff = value - this.lastMoneySupply;
        this.moneySupplyTrend = (diff&#x2F;this.lastMoneySupply) * (365&#x2F;days);
        this.lastMoneySupplyDayNumber = this.currentDayNumber;
        this.lastMoneySupply = value;
    }
    this.currentMoneySupply = value;
};

&#x2F;**
 * Returns the current value of the money supply.
 * 
 * @returns {int} Current value of the money supply.
 *&#x2F;
DebtLabBasic.prototype.getMoneySupply = function() {
    return this.currentMoneySupply;
};

&#x2F;**
 * Returns the trend for the current money supply as
 * a fraction per year plus or minus. This calculated 
 * periodically with the autoCountInterval.
 * 
 * @returns {float} money supply trend.
 *&#x2F;
DebtLabBasic.prototype.getMoneySupplyTrend = function() {
    return this.moneySupplyTrend;
}

&#x2F;&#x2F; ******** Interest Paid *********

&#x2F;**
 * Increment the interest paid and adjust yearly trend 
 * rate for interest
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.addInterestPaid = function(value) {
    
    &#x2F;&#x2F; Dampen change rate calculation
    &#x2F;&#x2F; var days = this.currentDayNumber - this.lastInterestDayNumber;
    &#x2F;&#x2F; if(days &gt; this.autoCountInterval) {
    &#x2F;&#x2F;    var diff = value - this.lastIn;
    &#x2F;&#x2F;    this.moneySupplyTrend = (diff&#x2F;this.lastMoneySupply) * (365&#x2F;days);
    &#x2F;&#x2F;    this.lastMoneySupplyDayNumber = this.currentDayNumber;
    &#x2F;&#x2F;    this.lastMoneySupply = value;
    &#x2F;&#x2F; }
    this.interestPaid += value;
};

&#x2F;**
 * Returns the total interest paid to lender.
 * 
 * @returns {int} total interest paid.
 *&#x2F;
DebtLabBasic.prototype.getInterestPaid = function() {
    return this.interestPaid;
};

&#x2F;**
 * Returns the trend for the yearly interest 
 * payments
 * 
 * @returns {float} interest payments trend.
 *&#x2F;
DebtLabBasic.prototype.getInterestPaidTrend = function() {
    return this.interestPaidTrend;
}

&#x2F;&#x2F; ******** Debt to Lender *********

&#x2F;**
 * Set the current debt to lender and calculate trend
 * rate for debt
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.setDebtToLender = function(value) {
    
    &#x2F;&#x2F; Dampen change rate calculation
    &#x2F;&#x2F; var days = this.currentDayNumber - this.lastInterestDayNumber;
    &#x2F;&#x2F; if(days &gt; this.autoCountInterval) {
    &#x2F;&#x2F;    var diff = value - this.lastIn;
    &#x2F;&#x2F;    this.moneySupplyTrend = (diff&#x2F;this.lastMoneySupply) * (365&#x2F;days);
    &#x2F;&#x2F;    this.lastMoneySupplyDayNumber = this.currentDayNumber;
    &#x2F;&#x2F;    this.lastMoneySupply = value;
    &#x2F;&#x2F; }
    this.debtToLender= value;
};

&#x2F;**
 * Returns the current debt to lender
 * 
 * @returns {int} current debt to lender.
 *&#x2F;
DebtLabBasic.prototype.getDebtToLender = function() {
    return this.debtToLender;
};

&#x2F;**
 * Returns the trend for the debt to lender 
 * 
 * @returns {float} debt to lender trend.
 *&#x2F;
DebtLabBasic.prototype.getDebtToLenderTrend = function() {
    return this.debtToLenderTrend;
}


&#x2F;&#x2F; ******* Lender Payback ********

&#x2F;**
 * Sets the simulator to default on notes as they become due.
 * 
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setDefaultOnPaybackFlag = function(value) {
    this.defaultOnPayBackFlag = value;
};


&#x2F;**
 * Returns a boolean indicating if the simulator is automatically
 * defaulting on notes as they become due
 * 
 * @returns {boolean} current value of auto borrow flag.
 *&#x2F;
DebtLabBasic.prototype.getDefaultOnPaybackFlag = function() {
    return this.defaultOnPayBackFlag;
};


&#x2F;&#x2F; ***** Lender Spends ******

&#x2F;**
 * Lender spends allows spending of lender interest back into the money supply.
 *&#x2F;
DebtLabBasic.prototype.doLenderSpend = function() {
    
    
    this.setLenderAccountBalance(this.lenderAccountBalance -= (this.lastInterestPayment * this.lenderSpendRate));
     
};


&#x2F;**
 * Spend rate of last interest payment.
 * 
 * @param {float} value 
 *&#x2F;
DebtLabBasic.prototype.setLenderSpendRate = function(value) {
    this.lenderSpendRate = value;
};

&#x2F;**
 * Returns the spend rate of last interest payment.
 * 
 * @returns {float} Current value of the spend rate of last interest payment.
 *&#x2F;
DebtLabBasic.prototype.getLenderSpendRate = function() {
    return this.lenderSpendRate;
};


&#x2F;**
 * Sets the simulator to automatically spend a percentage
 * of interest payments.
 * 
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setAutoLenderSpendFlag = function(value) {
    this.autoLenderSpendFlag = value;
};

&#x2F;**
 * Returns a boolean indicating if the simulator is automatically
 * spending a percentage of interest payments
 * 
 * @returns {boolean} current value of auto borrow flag.
 *&#x2F;
DebtLabBasic.prototype.getAutoLenderSpendFlag = function() {
    return this.autoLenderSpendFlag;
};

&#x2F;&#x2F; ***** Tax Lender ******

&#x2F;**
 * Tax lender allows taxing of lender interest back into the money supply.
 *&#x2F;
DebtLabBasic.prototype.doTaxLender = function() {
    
    this.setLenderAccountBalance(this.lenderAccountBalance -= (this.lastInterestPayment * this.lenderTaxRate));
     
};


&#x2F;**
 * Tax rate of last interest payment.
 * 
 * @param {float} value 
 *&#x2F;
DebtLabBasic.prototype.setTaxRate = function(value) {
    this.lenderTaxRate = value;
};

&#x2F;**
 * Returns the tax rate of last interest payment.
 * 
 * @returns {float} Current value of the tax rate of last interest payment.
 *&#x2F;
DebtLabBasic.prototype.getTaxRate = function() {
    return this.lenderTaxRate;
};




&#x2F;**
 * Sets the simulator to automatically tax a percentage
 * of interest payments.
 * 
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setAutoTaxLenderFlag = function(value) {
    this.autoTaxLenderFlag = value;
};


&#x2F;**
 * Returns a boolean indicating if the simulator is automatically
 * taxing a percentage of interest payments
 * 
 * @returns {boolean} current value of auto borrow flag.
 *&#x2F;
DebtLabBasic.prototype.getAutoTaxLenderFlag = function() {
    return this.autoTaxLenderFlag;
};



&#x2F;&#x2F; ***** Add to Lender Account ******

&#x2F;**
 * Add to lender account box allows adding
 * arbitrary or automatic money to lender&#x27;s private account.
 *&#x2F;
DebtLabBasic.prototype.doAddToLenderAccount = function() {
    this.setLenderAccountBalance(this.lenderAccountBalance += this.lenderAccountAddAmount);
   
    
};


&#x2F;**
 * Sets the amount to add to lender account.
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.setLenderAccountAddAmount = function(value) {
    this.lenderAccountAddAmount = value;
};

&#x2F;**
 * Returns the amount to add to lender account.
 * 
 * @returns {int} the amount to add to lender account.
 *&#x2F;
DebtLabBasic.prototype.getLenderAccountAddAmount = function() {
    return this.lenderAccountAddAmount;
};



&#x2F;**
 * Sets the simulator to automatically add to lender account
 * as needed.
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setAutoAddToLenderAccountFlag = function(value) {
    this.autoAddToLenderAccountFlag = value;
};


&#x2F;**
 * Returns a boolean indicating if the simulator is automatically
 * maintaining lender account.
 * 
 * @returns {boolean} current value of auto borrow flag.
 *&#x2F;
DebtLabBasic.prototype.getAutoAddToLenderAccountFlag = function() {
    return this.autoAddToLenderAccountFlag;
};





&#x2F;&#x2F; ******** Borrow *********

&#x2F;**Borrow money creates a note with the currently 
 * set parameters of amount and interest rate and 
 * adds the amount to the money supply. 
 *&#x2F;
DebtLabBasic.prototype.doBorrow = function() {
    &#x2F;&#x2F; this.paybackNote();
    &#x2F;&#x2F; TODO: Implement the borrow operations
    &#x2F;&#x2F; alert(&quot;Borrowing Money&quot;);
    
    &#x2F;&#x2F; Add note to notesOutstanding;
    
    if(this.lenderAccountBalance &lt; this.noteAmount) {
        if(this.autoAddToLenderAccountFlag) {
            this.lenderAccountBalance += this.noteAmount;
        } else {
            return;
        }
    }
    
    var interest = Math.ceil((this.noteTermDays&#x2F;365) * this.noteInterestRate * this.noteAmount);
    
    this.notesOutstanding.push({
        due: this.currentDayNumber + this.noteTermDays,
        amount: this.noteAmount,
        interest: interest
        
    });
    
    this.lenderAccountBalance -= this.noteAmount;
    this.currentMoneySupply += this.noteAmount;
    this.debtToLender += (this.noteAmount + interest);
    console.log(this.notesOutstanding.length);
    console.log(&quot;Interest:&quot; + interest);
    
    
};

&#x2F;**
 * Sets the simulator to automatically borrow from lender on demand.
 * 
 * @param {boolean} value 
 *&#x2F;
DebtLabBasic.prototype.setAutoBorrowFlag = function(value) {
    this.autoBorrowFlag = value;
};

&#x2F;**
 * Returns a boolean indicating if the simulator is automatically borrowing
 * to maintain money supply.
 * 
 * @returns {boolean} current value of auto borrow flag.
 *&#x2F;
DebtLabBasic.prototype.getAutoBorrowFlag = function() {
    return this.autoBorrowFlag;
};


&#x2F;**
 * Sets the current amount for new notes.
 * 
 * @param {String} value 
 *&#x2F;
DebtLabBasic.prototype.setNoteAmount = function(value) {
    this.noteAmount = value;
};

&#x2F;**
 * Returns the current amount for new notes.
 * 
 * @returns {String} Current amount for new notes.
 *&#x2F;
DebtLabBasic.prototype.getNoteAmount = function() {
    return this.noteAmount;
};


&#x2F;**
 * Interest rate for new notes.
 * 
 * @param {float} value 
 *&#x2F;
DebtLabBasic.prototype.setNoteInterestRate = function(value) {
    this.noteInterestRate = value;
};

&#x2F;**
 * Returns the interest rate for new notes.
 * 
 * @returns {float} Current interest rate for new notes.
 *&#x2F;
DebtLabBasic.prototype.getNoteInterestRate = function() {
    return this.noteInterestRate;
};

&#x2F;&#x2F; ***** Lender&#x27;s Account ******

&#x2F;**
 * Lender account shows the amount of money that the 
 * lender is holding out of economy.  
 * 
 * @param {int} value 
 *&#x2F;
DebtLabBasic.prototype.setLenderAccountBalance = function(value) {
    
    &#x2F;&#x2F; Dampen change rate calculation
    &#x2F;&#x2F; var days = this.currentDayNumber - this.lastMoneySupplyDayNumber;
    &#x2F;&#x2F; if(days &gt; this.autoCountInterval) {
    &#x2F;&#x2F;    var diff = value - this.lastMoneySupply;
    &#x2F;&#x2F;    this.moneySupplyTrend = (diff&#x2F;this.lastMoneySupply) * (365&#x2F;days);
    &#x2F;&#x2F;    this.lastMoneySupplyDayNumber = this.currentDayNumber;
    &#x2F;&#x2F;    this.lastMoneySupply = value;
    &#x2F;&#x2F; }
    this.lenderAccountBalance = value;
};

&#x2F;**
 * Returns the current balance of the lender&#x27;s account.
 * 
 * @returns {int} Current balance of the lender&#x27;s account.
 *&#x2F;
DebtLabBasic.prototype.getLenderAccountBalance = function() {
    return this.lenderAccountBalance;
};


&#x2F;**
 * Checks all the automatic flags and applies the appropriate
 * operations to the state of the simulator. Called with each 
 * autoCountInterval steps through the simulation. This is done
 * to avoid truncation of small integer values calculated
 * on a daily basis.
 *&#x2F;
DebtLabBasic.prototype.handleAutoFlags = function() {
    
    
    var limit = 20;
    var counter = 0;
    &#x2F;&#x2F; Calculate the number of virtual days that have passed
    var vDays = (this.multiplier * 365)&#x2F;this.autoCountInterval;
    
    &#x2F;&#x2F; Auto Public Money
    if( this.autoCreatePublicMoneyFlag) {
       while((this.currentMoneySupply &lt; this.targetMoneySupply) &amp;&amp; (counter &lt; limit)) {
         counter++;
         this.doCreatePublicMoney();
       }
    }
    
    &#x2F;&#x2F; Auto Target Money Supply
    if (this.autoTargetMoneySupplyGrowFlag) {
        this.targetMoneySupply += ((this.targetMoneySupply * this.targetMoneySupplyGrowthRate) &#x2F; vDays);
        
    }
    
    &#x2F;&#x2F; Keep enough money in lender account to make a loan
    if ( this.autoAddToLenderAccountFlag) {
        if( this.lenderAccountBalance &lt; this.noteAmount) {
            this.doAddToLenderAccount();
        }
    }
    

    &#x2F;&#x2F; Auto borrow to maintain money supply
    if ( this.autoBorrowFlag) {
        while((this.targetMoneySupply &gt; this.currentMoneySupply) &amp;&amp; (counter &lt; limit)) {
            counter++;
            this.doBorrow();
        }
    }
    

};


&#x2F;**
 * When called this returns true if the notesPayedQueue
 * is greater than 0. It then decrements the queue.
 *&#x2F;
DebtLabBasic.prototype.popNotesPayed = function() {
    
    if (this.notesPayedQueue &gt; 0) {
        this.notesPayedQueue -= 1;
        return true;
    } else {
        return false;
    }
    
};

&#x2F;**
 * When called this returns true if the notesDefaultedQueue
 * is greater than 0. It then decrements the queue.
 *&#x2F;
DebtLabBasic.prototype.popNotesDefaulted = function() {
    if ( this.notesDefaultedQueue &gt; 0) {
        this.notesDefaultedQueue -= 1;
        return true;
    } else {
        return false;
    }
};

       
   

DebtLabBasic.prototype.AverageArray = function(ar) {
    var sum = 0.0;
    for(var i = 0; i &lt; ar.length; i++) {
        sum += ar[i];
    }
    return sum&#x2F;ar.length;
}




    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
